<?xml version="1.0" encoding="utf-8" ?>

<scope
	xmlns="http://metalx.org/Program"
	xmlns:var="http://metalx.org/Variable"
	xmlns:cpu="http://metalx.org/Intel/80386/Operators"
	xmlns:op="http://metalx.org/Intel/80386/Operands"
	xmlns:math="http://metalx.org/Intel/80386/Math"
	xmlns:ari="http://metalx.org/Intel/80386/Arithmetic"
	xmlns:inc="http://metalx.org/Intel/80386/Increment"
	xmlns:imm="http://metalx.org/Intel/80386/Immediate"
	xmlns:shift="http://metalx.org/Intel/80386/Shift"
	xmlns:logic="http://metalx.org/Intel/80386/Logic">
	
	<label id="entryPoint" export="Application.EntryPoint"/>
	
	<cpu:CopyImmediateToAX/>
	<addressOf ref="user32FileName" type="Absolute32"/>

	<cpu:PushAXToStack/>

	<cpu:LogicFunction/>
	<logic:CallImmediateAddress/>
	<addressOf ref="ExeHeader.LoadLibrary" type="Absolute32"/>

	<cpu:CopyImmediateToBX/>
	<addressOf ref="messageBoxMethodName" type="Absolute32"/>

	<cpu:PushBXToStack/>
	<cpu:PushAXToStack/>

	<cpu:LogicFunction/>
	<logic:CallImmediateAddress/>
	<addressOf ref="ExeHeader.GetProcAddress" type="Absolute32"/>

	<cpu:CopyImmediateToBX/>
	<int>0</int>

	<cpu:CopyImmediateToCX/>
	<addressOf ref="message" type="Absolute32"/>

	<cpu:PushBXToStack/>
	<cpu:PushCXToStack/>
	<cpu:PushCXToStack/>
	<cpu:PushBXToStack/>

	<cpu:LogicFunction/>
	<logic:CallAXRegister/>
	
	<cpu:ReturnToNearCaller/>

	<label id="user32FileName"/>
	<string>user32.dll</string>
	<byte>0</byte>

	<label id="messageBoxMethodName"/>
	<string>MessageBoxA</string>
	<byte>0</byte>

	<label id="message"/>
	<string>Hello World!</string>
	<byte>0</byte>
</scope>