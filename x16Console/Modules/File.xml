<?xml version="1.0" encoding="utf-8"?>

<scope
	xmlns="http://metalx.org/Program"
	xmlns:cpu="http://metalx.org/Mos/6502/Operators"
	xmlns:mem="http://metalx.org/6502/Functions/Memory"
	xmlns:str="http://metalx.org/6502/Functions/String"
	xmlns:mm="http://metalx.org/6502/Functions/MemoryManager"
	xmlns:clsf="http://metalx.org/C64/Functions/Class"
	xmlns:cls="http://metalx.org/Class"
	xmlns:scr="http://metalx.org/x16Console/Functions/Screen"
	xmlns:ascii="http://metalx.org/Ansi/Ascii"
	xmlns:petscii="http://metalx.org/Commodore64/Petscii"
	xmlns:var="http://metalx.org/Variable">

	<!--Kernel Methods-->
	<!--SetFileParameters(fileNumber, deviceNumber, secondaryAddress)-->
	<label id="Kernal.SetFileParameters" offset="FFBA"/>
	<!--SetFileName(length, addressLow, addressHigh)-->
	<label id="Kernal.SetFileName" offset="FFBD"/>
	<!--LoadFile(verifyOnly, addressLow, addressHigh)-->
	<label id="Kernal.LoadFile" offset="FFD5"/>

	<label id="load" export="File.Load">
		<!--Set Filename-->
		<cpu:CallImmediate16Address/>
		<addressOf ref="Kernal.SetFileName" type="Absolute16"/>

		<!--Set File Parameters-->
		<cpu:CopyImmediate8ToAccumulator/>
		<byte>1</byte>

		<cpu:CopyImmediate8ToXIndex/>
		<byte>8</byte>

		<cpu:CopyImmediate8ToYIndex/>
		<byte>0</byte>

		<cpu:CallImmediate16Address/>
		<addressOf ref="Kernal.SetFileParameters" type="Absolute16"/>

		<!--Load File-->
		<cpu:CopyImmediate8ToAccumulator/>
		<byte>0</byte>

		<cpu:CopyImmediate8AddressToXIndex/>
		<hex>02</hex>

		<cpu:CopyImmediate8AddressToXIndex/>
		<hex>03</hex>

		<cpu:CallImmediate16Address/>
		<addressOf ref="Kernal.LoadFile" type="Absolute16"/>

		<cpu:ReturnFromSubroutine/>
	</label>
</scope>